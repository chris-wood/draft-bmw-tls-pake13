<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>A Password Authenticated Key Exchange Extension for TLS 1.3</title>
<meta content="Laura Bauman" name="author">
<meta content="David Benjamin" name="author">
<meta content="Samir Menon" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       The pre-shared key mechanism available in TLS 1.3 is not suitable
for usage with low-entropy keys, such as passwords entered by users.
This document describes an extension that enables the use of
password-authenticated key exchange protocols with TLS 1.3. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-bmw-tls-pake13-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-bmw-tls-pake13.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TLS 1.3 PAKE</td>
<td class="right">July 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bauman, et al.</td>
<td class="center">Expires 2 January 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-bmw-tls-pake13-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-07-01" class="published">1 July 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-01-02">2 January 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">L. Bauman</div>
<div class="org">Apple, Inc.</div>
</div>
<div class="author">
      <div class="author-name">D. Benjamin</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">S. Menon</div>
<div class="org">Apple, Inc.</div>
</div>
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Apple, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">A Password Authenticated Key Exchange Extension for TLS 1.3</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The pre-shared key mechanism available in TLS 1.3 is not suitable
for usage with low-entropy keys, such as passwords entered by users.
This document describes an extension that enables the use of
password-authenticated key exchange protocols with TLS 1.3.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Transport Layer Security Working Group mailing list (tls@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/chris-wood/draft-bmw-tls-pake13">https://github.com/chris-wood/draft-bmw-tls-pake13</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 January 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-setup" class="internal xref">Setup</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-pake-integration-in-tls" class="internal xref">PAKE Integration in TLS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-client-behavior" class="internal xref">Client Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-server-behavior" class="internal xref">Server Behavior</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-key-schedule-modifications" class="internal xref">Key Schedule Modifications</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-server-simulation" class="internal xref">Server Simulation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-compatible-pake-protocols" class="internal xref">Compatible PAKE Protocols</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-spake2-integration" class="internal xref">SPAKE2+ Integration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-protocol-setup" class="internal xref">Protocol Setup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-protocol-execution" class="internal xref">Protocol Execution</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-dictionary-attack-mitigatio" class="internal xref">Dictionary attack mitigation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-protection-of-client-identi" class="internal xref">Protection of client identities</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-ramifications-of-low-entrop" class="internal xref">Ramifications of low entropy secret compromise</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-spake2-security-considerati" class="internal xref">SPAKE2+ Security Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-pake-scheme-registry" class="internal xref">PAKE Scheme registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DISCLAIMER: Much of this text is copied from <span>[<a href="#FIRST-DRAFT" class="cite xref">FIRST-DRAFT</a>]</span>
and is in the process of being updated. This is a work-in-progress draft and has
not yet seen significant security analysis. See <a href="#security" class="auto internal xref">Section 8</a> and <a href="#spake2plus-sec" class="auto internal xref">Section 8.4</a>
for more information.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In some applications, it is desirable to enable a client and server
to authenticate to one another using a low-entropy pre-shared value,
such as a user-entered password.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">In prior versions of TLS, this functionality has been provided by
the integration of the Secure Remote Password PAKE protocol (SRP)
<span>[<a href="#RFC5054" class="cite xref">RFC5054</a>]</span>. The specific SRP integration described in RFC 5054
does not immediately extend to TLS 1.3 because it relies on the
Client Key Exchange and Server Key Exchange messages, which no
longer exist in 1.3.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">TLS 1.3 itself provides a mechanism for authentication with
pre-shared keys (PSKs). However, PSKs used with this protocol need
to be "full-entropy", because the binder values used for
authentication can be used to mount a dictionary attack on the PSK.
So while the TLS 1.3 PSK mechanism is suitable for the session
resumption cases for which it is specified, it cannot be used when
the client and server share only a low-entropy secret.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Enabling TLS to address this use case effectively requires the TLS
handshake to execute a password-authenticated key establishment
(PAKE) protocol. This document describes a TLS extension <code>pake</code>
that can carry data necessary to execute a PAKE.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This extension is generic, in that it can be used to carry key
exchange information for multiple different PAKEs. We assume that
prior to the TLS handshake the client and server will both have
knowledge of the password or PAKE-specific values derived from the
password (e.g. augmented PAKEs only require one party to know the
actual password). The choice of PAKE and any required parameters will
be explicitly specified using IANA assigned values. As a first
case, this document defines a concrete protocol for executing the
SPAKE2+ PAKE protocol <span>[<a href="#RFC9383" class="cite xref">RFC9383</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The mechanisms described in this document also apply to DTLS 1.3
<span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, but for brevity, we will refer only to TLS
throughout.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="setup">
<section id="section-3">
      <h2 id="name-setup">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-setup" class="section-name selfRef">Setup</a>
      </h2>
<p id="section-3-1">In order to use the extension specified in this document, a TLS client
and server need to have pre-provisioned a password (or derived values
as described by the desired PAKE protocol(s)). The details of this
pre-provisioned information are specific to each PAKE algorithm and
are not specified here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Servers will of course have multiple instances of this configuration
information for different clients. Clients may also have multiple
identities, even within a given server.<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pake-integration-in-tls">
<section id="section-4">
      <h2 id="name-pake-integration-in-tls">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-pake-integration-in-tls" class="section-name selfRef">PAKE Integration in TLS</a>
      </h2>
<p id="section-4-1">This section describes how the PAKE protocol is integrated and executed
in the TLS handshake.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="client-behavior">
<section id="section-4.1">
        <h3 id="name-client-behavior">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-client-behavior" class="section-name selfRef">Client Behavior</a>
        </h3>
<p id="section-4.1-1">To offer support for a PAKE protocol, the client sends a <code>pake</code> extension
in the ClientHello carrying a <code>PAKEClientHello</code> value:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
enum {
    pake(0xTODO), (65535)
} ExtensionType;
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">The payload of the client extension has the following <code>PAKEClientHello</code>
structure:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-4">
<pre>
enum {
    SPAKE2PLUS_V1 (0xXXXX),
} PAKEScheme;

struct {
    PAKEScheme   pake_scheme;
    opaque      pake_message&lt;1..2^16-1&gt;;
} PAKEShare;

struct {
    opaque    client_identity&lt;0..2^16-1&gt;;
    opaque    server_identity&lt;0..2^16-1&gt;;
    PAKEShare client_shares&lt;0..2^16-1&gt;;
} PAKEClientHello;
</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1-5">The <code>PAKEClientHello</code> structure consists of an identity pair under which the
client can authenticate alongside a list of PAKE algorithms and the
client's first message for each underlying PAKE protocol.
Concretely, these structure fields are defined as follows:<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-6">
          <dt id="section-4.1-6.1">client_shares</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-6.2">
            <p id="section-4.1-6.2.1">A list of PAKEShare values, each one with a distinct PAKEScheme algorithm.<a href="#section-4.1-6.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-6.3">client_identity</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-6.4">
            <p id="section-4.1-6.4.1">The client identity used for the PAKE. It may be empty.<a href="#section-4.1-6.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-6.5">server_identity</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-6.6">
            <p id="section-4.1-6.6.1">The server identity used for the PAKE. It may be empty.<a href="#section-4.1-6.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-6.7">pake_scheme</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-6.8">
            <p id="section-4.1-6.8.1">The 2-byte identifier of the PAKE algorithm.<a href="#section-4.1-6.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-6.9">pake_message</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-6.10">
            <p id="section-4.1-6.10.1">The client PAKE message used to initialize the protocol.<a href="#section-4.1-6.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-7">The client and server identity fields are common to all PAKEShares to prevent
client enumeration attacks; see <a href="#security" class="auto internal xref">Section 8</a>.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The <code>PAKEScheme</code> field in the <code>PAKEShare</code> allows implementations to
support multiple PAKEs and negotiate which to use in the context of
the handshake. For instance, if a client knows a password but not which
PAKE the server supports it could send corresponding PAKEShares for each
PAKE. If the client sends multiple PAKEShare values, then they <span class="bcp14">MUST</span>
be sorted in monotonically increasing order by the NamedPAKE value. Moreover,
the client <span class="bcp14">MUST NOT</span> send more than one PAKEShare with the same NamedPAKE value.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9"><span><a href="https://rfc-editor.org/rfc/rfc8446#section-9.2" class="relref">Section 9.2</a> of [<a href="#TLS13" class="cite xref">TLS13</a>]</span> specifies that a valid ClientHello
must include either a <code>pre_shared_key</code> extension or both
a <code>signature_algorithms</code> and <code>supported_groups</code> extension. With the
addition of the <code>pake</code> extension specified here, the new requirement
is that a valid ClientHello must satisfy at least one of the
following options:<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-10.1">
            <p id="section-4.1-10.1.1">includes a <code>pre_shared_key</code> extension<a href="#section-4.1-10.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-10.2">
            <p id="section-4.1-10.2.1">includes <code>signature_algorithms</code>, <code>supported_groups</code>, and <code>key_share</code>  extensions<a href="#section-4.1-10.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-10.3">
            <p id="section-4.1-10.3.1">includes <code>pake</code>, <code>supported_groups</code>, and <code>key_share</code> extensions<a href="#section-4.1-10.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-11">If a client sends the <code>pake</code> extension, then it <span class="bcp14">MUST</span> also send a <code>supported_groups</code> and
<code>key_share</code> extension. Like PSK-based authentication in psk_dhe_ke mode as defined in
<span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.2.0" class="relref">Section 4.2.0</a> of [<a href="#TLS13" class="cite xref">TLS13</a>]</span>, authentication with the <code>pake</code> extension
is always combined with the normal TLS key exchange mechanism. See <a href="#key-sched-mods" class="auto internal xref">Section 4.3</a> for details.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1-12">Combining the <code>pake</code> extension with the normal TLS key exchange mechanism
using a hybrid or PQ key agreement protects against Harvest Now Decrypt
Later Attacks where traffic recorded today may be decrypted by a Cryptographically
Relevant Quantum Computer (CRQC) in the future. However, if the PAKE used is not quantum secure,
then an active quantum attacker may still break authentication.<a href="#section-4.1-12" class="pilcrow">¶</a></p>
<p id="section-4.1-13">A client which sends both a <code>pake</code> and <code>signature_algorithms</code> extension indicates the client
requires both PAKE authentication and standard server certificate authentication.<a href="#section-4.1-13" class="pilcrow">¶</a></p>
<p id="section-4.1-14">The client <span class="bcp14">MAY</span> also send a <code>pre_shared_key</code> extension along with the <code>pake</code> extension,
to allow the server to choose an authentication mode.<a href="#section-4.1-14" class="pilcrow">¶</a></p>
<p id="section-4.1-15">The server identity value provided in the PAKEClientHello structure
are disjoint from that which the client may provide in the
ServerNameIndication (SNI) field.<a href="#section-4.1-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-behavior">
<section id="section-4.2">
        <h3 id="name-server-behavior">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-server-behavior" class="section-name selfRef">Server Behavior</a>
        </h3>
<p id="section-4.2-1">A server that receives a <code>pake</code> extension examines its contents to determine
if it is well-formed. In particular, if the list of PAKEShare values is not
sorted in monotonically increasing order by PAKEScheme values, or if there are
duplicate PAKEScheme entries in this list, the server aborts the handshake with
an "illegal_parameter" alert.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">If the list of PAKEShare values is well-formed, the server then scans the list
of PAKEShare values to determine if there is one corresponding to a server
supported PAKEScheme. If the server does not support any of the offered PAKESchemes
in the client PAKEShares then the server <span class="bcp14">MUST</span> abort the protocol
with an "illegal_parameter" alert.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">If the server has a PAKEScheme in common with the client then the server uses
the client_identity and server_identity alongside its local database of PAKE
registration information to determine if the request corresponds to a legitimate
client registration record. If one does not
exist, the server <span class="bcp14">MAY</span> simulate a PAKE response as described in <a href="#simulation" class="auto internal xref">Section 4.4</a>.
Simulating a response prevents client enumeration attacks on the server's
PAKE database; see <a href="#security" class="auto internal xref">Section 8</a>.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">If there exists a valid PAKE registration, the server indicates its selection
by including a <code>pake</code> extension in its ServerHello. The content of this extension
is a <code>PAKEServerHello</code> value, specifying the PAKE the server has selected, and the
server's first message in the PAKE protocol. The format of this structure is as follows:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-5">
<pre>
struct {
    PAKEShare server_share;
} PAKEServerHello;
</pre><a href="#section-4.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2-6">The server_share value of this structure is a <code>PAKEShare</code>, which echoes
back the PAKE algorithm chosen and the server's PAKE message generated
in response to the client's PAKE message.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">If a server uses PAKE authentication, then it <span class="bcp14">MUST NOT</span> send an
extension of type <code>pre_shared_key</code>, or <code>early_data</code>.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">Use of PAKE authentication <span class="bcp14">MAY</span> be used with
certificate-based authentication of both clients and servers.
If use of a PAKE is negotiated and the client included the <code>signature_algorithms</code> extension,
then servers <span class="bcp14">MUST</span> include Certificate and CertificateVerify messages in the handshake.
The server <span class="bcp14">MAY</span> send a CertificateRequest for client certificate authentication.
See <a href="#security" class="auto internal xref">Section 8</a> for a discussion on different security considerations
depending on if certificates are used or not.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-sched-mods">
<section id="section-4.3">
        <h3 id="name-key-schedule-modifications">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-key-schedule-modifications" class="section-name selfRef">Key Schedule Modifications</a>
        </h3>
<p id="section-4.3-1">When the client and server agree on a PAKE to use, a shared secret derived
from the PAKE protocol is concatenated with the regular <code>ECDH(E)</code>
input and used as part of the <code>ECDH(E)</code> input to the TLS 1.3
key schedule. Details for the shared secret computation are left to the
specific PAKE algorithm. See <a href="#spake2plus" class="auto internal xref">Section 6</a> for information about how
the SPAKE2+ variant operates.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">As with client authentication via certificates, the server has not
authenticated the client until after it has received the client's
Finished message. When a server negotiates the use of this
mechanism for authentication, it <span class="bcp14">SHOULD NOT</span> send application data
before it has received the client's Finished message, as it would
otherwise be sending data to an unauthenticated client.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="simulation">
<section id="section-4.4">
        <h3 id="name-server-simulation">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-server-simulation" class="section-name selfRef">Server Simulation</a>
        </h3>
<p id="section-4.4-1">To simulate a fake PAKE response, the server does the following:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1">Select a PAKEScheme supported by the client and server, as normal.<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1">Include the <code>pake</code> extension in its ServerHello, containing a PAKEShare value with
the selected PAKEScheme and corresponding <code>pake_message</code>. To generate the <code>pake_message</code>
for this <code>PAKEShare</code> value, the server selects a value uniformly at random from
the set of possible values of the PAKE algorithm shares.<a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.3">
            <p id="section-4.4-2.3.1">Perform the rest of the protocol as normal.<a href="#section-4.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-3">Because the server's share was selected uniformly at random, the server will reject
the client's Finished message with overwhelming probability.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">A server that performs the simulation of the protocol acts only
as an all-or-nothing oracle for whether a given (identity, password) pair
is correct. If an attacker does not supply a correct pair, they do not learn
anything beyond this fact.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="compatible-pake-protocols">
<section id="section-5">
      <h2 id="name-compatible-pake-protocols">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-compatible-pake-protocols" class="section-name selfRef">Compatible PAKE Protocols</a>
      </h2>
<p id="section-5-1">In order to be usable with the <code>pake</code> extension, a PAKE protocol
must specify some syntax for its messages, and the protocol itself
must be compatible with the message flow described above.  A
specification describing the use of a particular PAKE protocol with
TLS must provide the following details:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">A <code>PAKEScheme</code> registered value indicating pre-provisioned parameters;<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">Content of the <code>pake_message</code> field in a ClientHello;<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.3">
          <p id="section-5-2.3.1">Content of the <code>pake_message</code> field in a ServerHello;<a href="#section-5-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.4">
          <p id="section-5-2.4.1">How the PAKE protocol is executed based on those messages; and<a href="#section-5-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.5">
          <p id="section-5-2.5.1">How the outputs of the PAKE protocol are used to create the PAKE portion of the<code>(EC)DHE</code> input to the TLS key schedule.<a href="#section-5-2.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">In addition, to be compatible with the security requirements of TLS
1.3, PAKE protocols defined for use with TLS 1.3 <span class="bcp14">MUST</span> provide
forward secrecy.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Several current PAKE protocols satisfy these requirements, for
example:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">
          <p id="section-5-5.1.1">CPace <span>[<a href="#CPACE" class="cite xref">CPACE</a>]</span><a href="#section-5-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.2">
          <p id="section-5-5.2.1">SPAKE2+ (described in <a href="#spake2plus" class="auto internal xref">Section 6</a>) <span>[<a href="#RFC9383" class="cite xref">RFC9383</a>]</span><a href="#section-5-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-5.3">
          <p id="section-5-5.3.1">OPAQUE <span>[<a href="#OPAQUE" class="cite xref">OPAQUE</a>]</span><a href="#section-5-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="spake2plus">
<section id="section-6">
      <h2 id="name-spake2-integration">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-spake2-integration" class="section-name selfRef">SPAKE2+ Integration</a>
      </h2>
<p id="section-6-1">This section describes the SPAKE2+ instantiation of the <code>pake</code> extension for TLS.
The SPAKE2+ protocol is described in <span>[<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>.
<a href="#spake2plus-setup" class="auto internal xref">Section 6.1</a> describes the setup required before the protocol runs,
and <a href="#spake2plus-run" class="auto internal xref">Section 6.2</a> describes the protocol execution in TLS.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="spake2plus-setup">
<section id="section-6.1">
        <h3 id="name-protocol-setup">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-protocol-setup" class="section-name selfRef">Protocol Setup</a>
        </h3>
<p id="section-6.1-1">The TLS client and server roles map to the <code>Prover</code> and <code>Verifier</code> roles in the
SPAKE2+ specification, respectively. Clients are configured with a client
identity, server identity, and password verifier (w0 and w1 according to <span>[<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>).
Similarly, servers are configured with a list of client identity, server identity,
and password registration values (w0 and L according to <span>[<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>). Servers
use this list when completing the SPAKE2+ protocol. The values for the password
verifiers and registration records (w0, w1, and L) are not specified here; see
<span><a href="https://rfc-editor.org/rfc/rfc9383#section-3.2" class="relref">Section 3.2</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span> for more information.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The PAKEScheme value for SPAKE2+ fully defines the parameters associated with
the protocol, including the prime-order group <code>G</code>, cryptographic hash function <code>Hash</code>,
key derivation function <code>KDF</code>, and message authentication code <code>MAC</code>. Additionally,
the PAKEScheme value for SPAKE2+ fully defines the constants for M and N
as needed for the protocol; see <span><a href="https://rfc-editor.org/rfc/rfc9383#section-4" class="relref">Section 4</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spake2plus-run">
<section id="section-6.2">
        <h3 id="name-protocol-execution">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-protocol-execution" class="section-name selfRef">Protocol Execution</a>
        </h3>
<p id="section-6.2-1">The content of one PAKEShare value in the PAKEClientHello structure consists
of the PAKEScheme value <code>SPAKE2PLUS_V1</code> and the value <code>shareP</code> as computed in
<span><a href="https://rfc-editor.org/rfc/rfc9383#section-3.3" class="relref">Section 3.3</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The content of the server PAKEShare value in the PAKEServerHello structure
consists of the PAKEScheme value <code>SPAKE2PLUS_V1</code> and the value <code>shareV || confirmV</code>,
i.e., <code>shareV</code> and <code>confirmV</code> concatenated, as computed in <span><a href="https://rfc-editor.org/rfc/rfc9383#section-3.3" class="relref">Section 3.3</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">Given <code>shareP</code> and <code>shareV</code>, the client and server can then both compute
K_main, the root secret in the protocol as described in <span><a href="https://rfc-editor.org/rfc/rfc9383#section-3.4" class="relref">Section 3.4</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>.
The "Context" value for SPAKE2+ may be specified by the application to include additional
context in the protocol transcript or left empty. See <span><a href="https://rfc-editor.org/rfc/rfc9383#section-3" class="relref">Section 3</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>. The rest of
the values needed for the transcript derivation are as configured in <a href="#spake2plus-setup" class="auto internal xref">Section 6.1</a>,
exchanged over the wire, or computed by client and server.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Using <code>K_main</code>, the client and server both compute <code>K_shared</code> which is combined with the
<code>(EC)DHE</code> shared secret as input to the TLS 1.3 key schedule. Specifically, <code>K_shared || (EC)DHE</code> is used
as the <code>(EC)DHE</code> input to the key schedule in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-7.1" class="relref">Section 7.1</a> of [<a href="#TLS13" class="cite xref">TLS13</a>]</span>, as shown below.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-5">
<pre>
                                    0
                                    |
                                    v
                        0 -&gt;  HKDF-Extract = Early Secret
                                    |
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    |
                                    v
                              Derive-Secret(., "derived", "")
                                    |
                                    v
                K_shared || (EC)DHE -&gt; HKDF-Extract = Handshake Secret
                ^^^^^^^^^^^         |
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    |
                                    v
                              Derive-Secret(., "derived", "")
                                    |
                                    v
                         0 -&gt; HKDF-Extract = Master Secret
                                    |
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
                                    +-----&gt; Derive-Secret(...)
</pre><a href="#section-6.2-5" class="pilcrow">¶</a>
</div>
<p id="section-6.2-6">Note that the server does compute and send confirmV as defined in <span><a href="https://rfc-editor.org/rfc/rfc9383#section-3.4" class="relref">Section 3.4</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>
since it can do so within the structure of the TLS 1.3 handshake and the client <span class="bcp14">MUST</span> verify it.
If verification of confirmV fails, clients <span class="bcp14">SHOULD</span> abort the handshake with a "decrypt_error" alert.
The client and server do not additionally compute or verify confirmP
as described in <span><a href="https://rfc-editor.org/rfc/rfc9383#section-3.4" class="relref">Section 3.4</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>.
See <a href="#spake2plus-sec" class="auto internal xref">Section 8.4</a> for more information about the safety of this approach.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">Client and server identities are sent in the clear in the PAKEClientHello extension.
While normally the TLS server identity is already in the clear -- carried in
the SNI extension -- TLS client identities are encrypted under the TLS handshake
secrets. Thus, the PAKEClientHello extension reveals more information to a passive
network attacker than normal, mutually-authenticated TLS handshakes.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The implications of leaking the client identity to a passive network attacker vary.
For instance, a successful TLS handshake after negotiating use of a PAKE indicates
that the chosen client identity is valid. This is relevant in settings where
client enumeration may be a concern.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Applications for which this leak is a problem can use the TLS Encrypted ClientHello
(ECH) extension to encrypt the PAKEClientHello extension in transit to the server
<span>[<a href="#ECH" class="cite xref">ECH</a>]</span>.<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="dictionary-attack-mitigation">
<section id="section-8.1">
        <h3 id="name-dictionary-attack-mitigatio">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-dictionary-attack-mitigatio" class="section-name selfRef">Dictionary attack mitigation</a>
        </h3>
<p id="section-8.1-1">Because PAKE security is based on knowledge of a low-entropy secret,
an attacker can perform a "dictionary attack" by repeatedly attempting to
guess the low-entropy secret.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Clients and servers <span class="bcp14">SHOULD</span> apply mitigations against dictionary attacks.
Reasonable mitigations include rate-limiting authentication attempts,
imposing a backoff time between attempts, limiting the
number of failed attempts, or limiting the total number
of attempts.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Clients <span class="bcp14">SHOULD</span> treat each time they receive an invalid PAKEServerHello
as a failed authentication attempt for the identity in the previously sent PAKEClientHello.
Servers <span class="bcp14">SHOULD</span> treat each time they send a PAKEServerHello extension as a failed
authentication attempt for the selected identity, until they receive a correct Finished
message from the client. Once the server receives a correct Finished message,
the authentication attempt <span class="bcp14">MAY</span> be treated as successful.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protection-of-client-identities">
<section id="section-8.2">
        <h3 id="name-protection-of-client-identi">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-protection-of-client-identi" class="section-name selfRef">Protection of client identities</a>
        </h3>
<p id="section-8.2-1">Many of the security properties of this protocol will derive from
the PAKE protocol being used. Security considerations for PAKE
protocols are noted in <a href="#compatible-pake-protocols" class="auto internal xref">Section 5</a>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">If a server doesn't recognize the identity supplied by the
client in the ClientHello <code>pake</code> extension, the server <span class="bcp14">MAY</span> abort the handshake with an
"illegal_parameter" alert. In this case, the server acts as an oracle
for identities, in which each handshake allows an attacker
to learn whether the server recognizes a given identity.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Alternatively, if the server wishes to hide the fact that a client
identity is unrecognized, the server <span class="bcp14">MAY</span> simulate the protocol as
if an identity was recognized, but the password was incorrect.
This is similar to the procedure outlined in <span>[<a href="#RFC5054" class="cite xref">RFC5054</a>]</span>.
The simulation mechanism is described in <a href="#simulation" class="auto internal xref">Section 4.4</a>.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ramifications-of-low-entropy-secret-compromise">
<section id="section-8.3">
        <h3 id="name-ramifications-of-low-entrop">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-ramifications-of-low-entrop" class="section-name selfRef">Ramifications of low entropy secret compromise</a>
        </h3>
<p id="section-8.3-1">As with PSK based authentication, if only PAKE authentication is in use,
then an attacker that learns the low entropy secret could impersonate
either the client or the server. In situations where a notion of stable identity
is available, then Certificate based authentication <span class="bcp14">MAY</span> be used as well to
reduce this risk. For example, requiring the server to authenticate with
a certificate in addition to PAKE authentication means an attacker
that learns the password could only impersonate a client not a server.
This is an important distinction in situations where
the client sends sensitive data to the server.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spake2plus-sec">
<section id="section-8.4">
        <h3 id="name-spake2-security-considerati">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-spake2-security-considerati" class="section-name selfRef">SPAKE2+ Security Considerations</a>
        </h3>
<p id="section-8.4-1"><a href="#spake2plus" class="auto internal xref">Section 6</a> describes how to integrate SPAKE2+ into TLS using the <code>pake</code>
extension in this document. This integration deviates from the SPAKE2+
protocol in <span>[<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span> in one important way: the explicit key confirmation
checks required in <span>[<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span> are replaced with the TLS Finished messages.
This is because the TLS Finished messages compute a MAC over the TLS transcript,
which includes both the <code>shareP</code> and <code>shareV</code> values exchanged for SPAKE2+.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">[[OPEN ISSUE: this requires formal analysis to confirm.]]<a href="#section-8.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document requests that IANA add a value to the TLS
ExtensionType Registry with the following contents:<a href="#section-9-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
            <th class="text-left" rowspan="1" colspan="1">Extension Name</th>
            <th class="text-center" rowspan="1" colspan="1">TLS 1.3</th>
            <th class="text-center" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0xTODO</td>
            <td class="text-left" rowspan="1" colspan="1">pake</td>
            <td class="text-center" rowspan="1" colspan="1">CH, SH</td>
            <td class="text-center" rowspan="1" colspan="1">(this document)</td>
          </tr>
        </tbody>
      </table>
<p id="section-9-3">[[ RFC EDITOR: Please replace "TODO" in the above table with the
value assigned by IANA, and replace "(this document)" with the
RFC number assigned to this document. ]]<a href="#section-9-3" class="pilcrow">¶</a></p>
<div id="pake-scheme-registry">
<section id="section-9.1">
        <h3 id="name-pake-scheme-registry">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-pake-scheme-registry" class="section-name selfRef">PAKE Scheme registry</a>
        </h3>
<p id="section-9.1-1">This document requests that IANA create a new registry called
"PAKE Schemes" with the following contents:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">PAKEScheme</th>
              <th class="text-center" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0xTODO</td>
              <td class="text-left" rowspan="1" colspan="1">SPAKE2PLUS_V1</td>
              <td class="text-center" rowspan="1" colspan="1">(this document)</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.1-3">The SPAKE2PLUS_V1 PAKEScheme variant has the following parameters associated with it:<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-4.1">
            <p id="section-9.1-4.1.1">G: P-256<a href="#section-9.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-4.2">
            <p id="section-9.1-4.2.1">Hash: SHA256<a href="#section-9.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-4.3">
            <p id="section-9.1-4.3.1">KDF: HKDF-SHA256<a href="#section-9.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-4.4">
            <p id="section-9.1-4.4.1">MAC: HMAC-SHA256<a href="#section-9.1-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.1-5">Additionally, it uses the M and N values from <span><a href="https://rfc-editor.org/rfc/rfc9383#section-4" class="relref">Section 4</a> of [<a href="#SPAKE2PLUS" class="cite xref">SPAKE2PLUS</a>]</span>, included
below, as compressed points on the P-256 curve, for completeness.<a href="#section-9.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.1-6">
<pre>
M =
02886e2f97ace46e55ba9dd7242579f2993b64e16ef3dcab95afd497333d8fa12f

N =
03d8bbd6c639c62937b04d997f38c3770719c629d7014d49a24b4f98baa1292b49
</pre><a href="#section-9.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-10">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-10-1">The authors would like to thank the original authors of <span>[<a href="#FIRST-DRAFT" class="cite xref">FIRST-DRAFT</a>]</span>
for providing a firm basis for the extension mechanism specified in this
document.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="CPACE">[CPACE]</dt>
        <dd>
<span class="refAuthor">Abdalla, M.</span>, <span class="refAuthor">Haase, B.</span>, and <span class="refAuthor">J. Hesse</span>, <span class="refTitle">"CPace, a balanced composable PAKE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-cpace-14</span>, <time datetime="2025-04-16" class="refDate">16 April 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-cpace-14">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-cpace-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9383">[RFC9383]</dt>
        <dd>
<span class="refAuthor">Taubert, T.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"SPAKE2+, an Augmented Password-Authenticated Key Exchange (PAKE) Protocol"</span>, <span class="seriesInfo">RFC 9383</span>, <span class="seriesInfo">DOI 10.17487/RFC9383</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9383">https://www.rfc-editor.org/rfc/rfc9383</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SPAKE2PLUS">[SPAKE2PLUS]</dt>
        <dd>
<span class="refAuthor">Taubert, T.</span> and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"SPAKE2+, an Augmented Password-Authenticated Key Exchange (PAKE) Protocol"</span>, <span class="seriesInfo">RFC 9383</span>, <span class="seriesInfo">DOI 10.17487/RFC9383</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9383">https://www.rfc-editor.org/rfc/rfc9383</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS13">[TLS13]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ECH">[ECH]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Oku, K.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"TLS Encrypted Client Hello"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-25</span>, <time datetime="2025-06-14" class="refDate">14 June 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-25">https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-25</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIRST-DRAFT">[FIRST-DRAFT]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span> and <span class="refAuthor">O. Friel</span>, <span class="refTitle">"Usage of PAKE with TLS 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-barnes-tls-pake-04</span>, <time datetime="2018-07-16" class="refDate">16 July 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-barnes-tls-pake-04">https://datatracker.ietf.org/doc/html/draft-barnes-tls-pake-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OPAQUE">[OPAQUE]</dt>
        <dd>
<span class="refAuthor">Bourdrez, D.</span>, <span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Lewi, K.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"The OPAQUE Augmented PAKE Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-opaque-18</span>, <time datetime="2024-11-21" class="refDate">21 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-opaque-18">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-opaque-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5054">[RFC5054]</dt>
      <dd>
<span class="refAuthor">Taylor, D.</span>, <span class="refAuthor">Wu, T.</span>, <span class="refAuthor">Mavrogiannopoulos, N.</span>, and <span class="refAuthor">T. Perrin</span>, <span class="refTitle">"Using the Secure Remote Password (SRP) Protocol for TLS Authentication"</span>, <span class="seriesInfo">RFC 5054</span>, <span class="seriesInfo">DOI 10.17487/RFC5054</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5054">https://www.rfc-editor.org/rfc/rfc5054</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Laura Bauman</span></div>
<div dir="auto" class="left"><span class="org">Apple, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:l_bauman@apple.com" class="email">l_bauman@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Benjamin</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:davidben@google.com" class="email">davidben@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samir Menon</span></div>
<div dir="auto" class="left"><span class="org">Apple, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:samir_menon@apple.com" class="email">samir_menon@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Apple, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
